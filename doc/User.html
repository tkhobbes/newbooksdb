<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: User
  
    &mdash; Documentation by YARD 0.9.28
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "User";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (U)</a> &raquo;
    
    
    <span class="title">User</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: User
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="ApplicationRecord.html" title="ApplicationRecord (class)">ApplicationRecord</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">ActiveRecord::Base</li>
          
            <li class="next"><span class='object_link'><a href="ApplicationRecord.html" title="ApplicationRecord (class)">ApplicationRecord</a></span></li>
          
            <li class="next">User</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>app/models/user.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<h2 id="label-Schema+Information">Schema Information</h2>

<p>Table name: users</p>

<p>Indexes</p>

<pre class="code ruby"><code class="ruby">index_users_on_email  (email) UNIQUE
</code></pre>


  </div>
</div>
<div class="tags">
  

</div>
  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="VALID_EMAIL_REGEX-constant" class="">VALID_EMAIL_REGEX =
          <div class="docstring">
  <div class="discussion">
    
<p>this is from Michael Hartl’s Rails Tutorial</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z</span><span class='regexp_end'>/i</span></span></pre></dd>
      
    </dl>
  




  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#activated-instance_method" title="#activated (instance method)">#<strong>activated</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#activated_at-instance_method" title="#activated_at (instance method)">#<strong>activated_at</strong>  &#x21d2; Time </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#activation_digest-instance_method" title="#activation_digest (instance method)">#<strong>activation_digest</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#activation_token-instance_method" title="#activation_token (instance method)">#<strong>activation_token</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>we need an attribute ‘remember_token’, ‘activation_token’ and ‘reset_token’ to store the token this line smells of :reek:Attribute.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#admin-instance_method" title="#admin (instance method)">#<strong>admin</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#created_at-instance_method" title="#created_at (instance method)">#<strong>created_at</strong>  &#x21d2; Time </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#email-instance_method" title="#email (instance method)">#<strong>email</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#id-instance_method" title="#id (instance method)">#<strong>id</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>[].</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#name-instance_method" title="#name (instance method)">#<strong>name</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#password_digest-instance_method" title="#password_digest (instance method)">#<strong>password_digest</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#remember_digest-instance_method" title="#remember_digest (instance method)">#<strong>remember_digest</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#remember_token-instance_method" title="#remember_token (instance method)">#<strong>remember_token</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>we need an attribute ‘remember_token’, ‘activation_token’ and ‘reset_token’ to store the token this line smells of :reek:Attribute.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#reset_digest-instance_method" title="#reset_digest (instance method)">#<strong>reset_digest</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#reset_sent_at-instance_method" title="#reset_sent_at (instance method)">#<strong>reset_sent_at</strong>  &#x21d2; Time </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#reset_token-instance_method" title="#reset_token (instance method)">#<strong>reset_token</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>we need an attribute ‘remember_token’, ‘activation_token’ and ‘reset_token’ to store the token this line smells of :reek:Attribute.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#updated_at-instance_method" title="#updated_at (instance method)">#<strong>updated_at</strong>  &#x21d2; Time </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#digest-class_method" title="digest (class method)">.<strong>digest</strong>(string)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>returns the hash digest of the given string.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#new_token-class_method" title="new_token (class method)">.<strong>new_token</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>returns a random token.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#activate-instance_method" title="#activate (instance method)">#<strong>activate</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>activates an account.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#authenticated%3F-instance_method" title="#authenticated? (instance method)">#<strong>authenticated?</strong>(attribute, token)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>returns true if the given token matches the digest this method smells of :reek:NilCheck.</p>
</div></span>
  
</li>

      
        <li class="private ">
  <span class="summary_signature">
    
      <a href="#create_activation_digest-instance_method" title="#create_activation_digest (instance method)">#<strong>create_activation_digest</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>creates and assignes the activation token and digest.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_reset_digest-instance_method" title="#create_reset_digest (instance method)">#<strong>create_reset_digest</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>sets password reset attributes.</p>
</div></span>
  
</li>

      
        <li class="private ">
  <span class="summary_signature">
    
      <a href="#downcase_email-instance_method" title="#downcase_email (instance method)">#<strong>downcase_email</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>convert email to all lowercase.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#forget-instance_method" title="#forget (instance method)">#<strong>forget</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>forgets a user.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#password_reset_expired%3F-instance_method" title="#password_reset_expired? (instance method)">#<strong>password_reset_expired?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>returns true if a password reset has expired.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remember-instance_method" title="#remember (instance method)">#<strong>remember</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Remembers a user in the database for use in persistent sessions.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#send_activation_email-instance_method" title="#send_activation_email (instance method)">#<strong>send_activation_email</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>sends an activation e-mail.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#send_password_reset_email-instance_method" title="#send_password_reset_email (instance method)">#<strong>send_password_reset_email</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>sends password reset email.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#session_token-instance_method" title="#session_token (instance method)">#<strong>session_token</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>returns a session token to prevent session hijacking we reuse the remember digest for convenience.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="activated=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="activated-instance_method">
  
    #<strong>activated</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 38</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="ApplicationRecord.html" title="ApplicationRecord (class)">ApplicationRecord</a></span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span>
  <span class='comment'># this is from Michael Hartl&#39;s Rails Tutorial
</span>  <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z</span><span class='regexp_end'>/i</span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:email</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>format:</span> <span class='lbrace'>{</span> <span class='label'>with:</span> <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>uniqueness:</span> <span class='kw'>true</span>

  <span class='id identifier rubyid_has_secure_password'>has_secure_password</span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:password</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>length:</span> <span class='lbrace'>{</span> <span class='label'>minimum:</span> <span class='int'>6</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_has_one_attached'>has_one_attached</span> <span class='symbol'>:avatar</span>

  <span class='comment'># application relations
</span>  <span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:books</span><span class='comma'>,</span> <span class='label'>dependent:</span> <span class='symbol'>:destroy</span>

  <span class='comment'># scopes
</span>  <span class='comment'># all users but the one with a specific ID
</span>  <span class='id identifier rubyid_scope'>scope</span> <span class='symbol'>:all_but</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_where'>where</span><span class='period'>.</span><span class='id identifier rubyid_not'>not</span><span class='lparen'>(</span><span class='label'>id:</span> <span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

  <span class='comment'># returns the hash digest of the given string
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cost'>cost</span> <span class='op'>=</span> <span class='const'>ActiveModel</span><span class='op'>::</span><span class='const'>SecurePassword</span><span class='period'>.</span><span class='id identifier rubyid_min_cost'>min_cost</span> <span class='op'>?</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='op'>::</span><span class='const'>MIN_COST</span> <span class='op'>:</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='period'>.</span><span class='id identifier rubyid_cost'>cost</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='label'>cost:</span> <span class='id identifier rubyid_cost'>cost</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># we need an attribute &#39;remember_token&#39;, &#39;activation_token&#39; and &#39;reset_token&#39; to store the token
</span>  <span class='comment'># this line smells of :reek:Attribute
</span>  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:remember_token</span><span class='comma'>,</span> <span class='symbol'>:activation_token</span><span class='comma'>,</span> <span class='symbol'>:reset_token</span>

  <span class='comment'># convert e-mail address to lowercase before saving
</span>  <span class='id identifier rubyid_before_save'>before_save</span> <span class='symbol'>:downcase_email</span>
  <span class='comment'># automatically create an activation digest
</span>  <span class='id identifier rubyid_before_create'>before_create</span> <span class='symbol'>:create_activation_digest</span>

  <span class='comment'># returns a random token.
</span>  <span class='comment'># this is a CLASS method
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_urlsafe_base64'>urlsafe_base64</span>
  <span class='kw'>end</span>

  <span class='comment'># Remembers a user in the database for use in persistent sessions
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_remember'>remember</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_remember_token'>remember_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_remember_token'>remember_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_remember_digest'>remember_digest</span>
  <span class='kw'>end</span>

  <span class='comment'># forgets a user
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_forget'>forget</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># returns true if the given token matches the digest
</span>  <span class='comment'># this method smells of :reek:NilCheck
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_authenticated?'>authenticated?</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_digest'>digest</span> <span class='op'>=</span> <span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_attribute'>attribute</span><span class='embexpr_end'>}</span><span class='tstring_content'>_digest</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_digest'>digest</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_digest'>digest</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_is_password?'>is_password?</span><span class='lparen'>(</span><span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># returns a session token to prevent session hijacking
</span>  <span class='comment'># we reuse the remember digest for convenience
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_session_token'>session_token</span>
    <span class='id identifier rubyid_remember_digest'>remember_digest</span> <span class='op'>||</span> <span class='id identifier rubyid_remember'>remember</span>
  <span class='kw'>end</span>

  <span class='comment'># activates an account
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_activate'>activate</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends an activation e-mail
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_activation_email'>send_activation_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_account_activation'><span class='object_link'><a href="UserMailer.html#account_activation-instance_method" title="UserMailer#account_activation (method)">account_activation</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># sets password reset attributes
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_reset_digest'>create_reset_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset_token'>reset_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_reset_token'>reset_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_sent_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends password reset email
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_password_reset_email'>send_password_reset_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_password_reset'><span class='object_link'><a href="UserMailer.html#password_reset-instance_method" title="UserMailer#password_reset (method)">password_reset</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># returns true if a password reset has expired
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_password_reset_expired?'>password_reset_expired?</span>
    <span class='id identifier rubyid_reset_sent_at'>reset_sent_at</span> <span class='op'>&lt;</span> <span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_hours'>hours</span><span class='period'>.</span><span class='id identifier rubyid_ago'>ago</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># convert email to all lowercase
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_downcase_email'>downcase_email</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span> <span class='op'>=</span> <span class='id identifier rubyid_email'>email</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
  <span class='kw'>end</span>

  <span class='comment'># creates and assignes the activation token and digest
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_activation_digest'>create_activation_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_token'>activation_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_digest'>activation_digest</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_activation_token'>activation_token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="activated_at=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="activated_at-instance_method">
  
    #<strong>activated_at</strong>  &#x21d2; <tt>Time</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Time</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 38</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="ApplicationRecord.html" title="ApplicationRecord (class)">ApplicationRecord</a></span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span>
  <span class='comment'># this is from Michael Hartl&#39;s Rails Tutorial
</span>  <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z</span><span class='regexp_end'>/i</span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:email</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>format:</span> <span class='lbrace'>{</span> <span class='label'>with:</span> <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>uniqueness:</span> <span class='kw'>true</span>

  <span class='id identifier rubyid_has_secure_password'>has_secure_password</span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:password</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>length:</span> <span class='lbrace'>{</span> <span class='label'>minimum:</span> <span class='int'>6</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_has_one_attached'>has_one_attached</span> <span class='symbol'>:avatar</span>

  <span class='comment'># application relations
</span>  <span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:books</span><span class='comma'>,</span> <span class='label'>dependent:</span> <span class='symbol'>:destroy</span>

  <span class='comment'># scopes
</span>  <span class='comment'># all users but the one with a specific ID
</span>  <span class='id identifier rubyid_scope'>scope</span> <span class='symbol'>:all_but</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_where'>where</span><span class='period'>.</span><span class='id identifier rubyid_not'>not</span><span class='lparen'>(</span><span class='label'>id:</span> <span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

  <span class='comment'># returns the hash digest of the given string
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cost'>cost</span> <span class='op'>=</span> <span class='const'>ActiveModel</span><span class='op'>::</span><span class='const'>SecurePassword</span><span class='period'>.</span><span class='id identifier rubyid_min_cost'>min_cost</span> <span class='op'>?</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='op'>::</span><span class='const'>MIN_COST</span> <span class='op'>:</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='period'>.</span><span class='id identifier rubyid_cost'>cost</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='label'>cost:</span> <span class='id identifier rubyid_cost'>cost</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># we need an attribute &#39;remember_token&#39;, &#39;activation_token&#39; and &#39;reset_token&#39; to store the token
</span>  <span class='comment'># this line smells of :reek:Attribute
</span>  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:remember_token</span><span class='comma'>,</span> <span class='symbol'>:activation_token</span><span class='comma'>,</span> <span class='symbol'>:reset_token</span>

  <span class='comment'># convert e-mail address to lowercase before saving
</span>  <span class='id identifier rubyid_before_save'>before_save</span> <span class='symbol'>:downcase_email</span>
  <span class='comment'># automatically create an activation digest
</span>  <span class='id identifier rubyid_before_create'>before_create</span> <span class='symbol'>:create_activation_digest</span>

  <span class='comment'># returns a random token.
</span>  <span class='comment'># this is a CLASS method
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_urlsafe_base64'>urlsafe_base64</span>
  <span class='kw'>end</span>

  <span class='comment'># Remembers a user in the database for use in persistent sessions
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_remember'>remember</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_remember_token'>remember_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_remember_token'>remember_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_remember_digest'>remember_digest</span>
  <span class='kw'>end</span>

  <span class='comment'># forgets a user
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_forget'>forget</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># returns true if the given token matches the digest
</span>  <span class='comment'># this method smells of :reek:NilCheck
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_authenticated?'>authenticated?</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_digest'>digest</span> <span class='op'>=</span> <span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_attribute'>attribute</span><span class='embexpr_end'>}</span><span class='tstring_content'>_digest</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_digest'>digest</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_digest'>digest</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_is_password?'>is_password?</span><span class='lparen'>(</span><span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># returns a session token to prevent session hijacking
</span>  <span class='comment'># we reuse the remember digest for convenience
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_session_token'>session_token</span>
    <span class='id identifier rubyid_remember_digest'>remember_digest</span> <span class='op'>||</span> <span class='id identifier rubyid_remember'>remember</span>
  <span class='kw'>end</span>

  <span class='comment'># activates an account
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_activate'>activate</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends an activation e-mail
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_activation_email'>send_activation_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_account_activation'><span class='object_link'><a href="UserMailer.html#account_activation-instance_method" title="UserMailer#account_activation (method)">account_activation</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># sets password reset attributes
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_reset_digest'>create_reset_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset_token'>reset_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_reset_token'>reset_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_sent_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends password reset email
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_password_reset_email'>send_password_reset_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_password_reset'><span class='object_link'><a href="UserMailer.html#password_reset-instance_method" title="UserMailer#password_reset (method)">password_reset</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># returns true if a password reset has expired
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_password_reset_expired?'>password_reset_expired?</span>
    <span class='id identifier rubyid_reset_sent_at'>reset_sent_at</span> <span class='op'>&lt;</span> <span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_hours'>hours</span><span class='period'>.</span><span class='id identifier rubyid_ago'>ago</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># convert email to all lowercase
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_downcase_email'>downcase_email</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span> <span class='op'>=</span> <span class='id identifier rubyid_email'>email</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
  <span class='kw'>end</span>

  <span class='comment'># creates and assignes the activation token and digest
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_activation_digest'>create_activation_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_token'>activation_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_digest'>activation_digest</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_activation_token'>activation_token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="activation_digest=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="activation_digest-instance_method">
  
    #<strong>activation_digest</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 38</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="ApplicationRecord.html" title="ApplicationRecord (class)">ApplicationRecord</a></span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span>
  <span class='comment'># this is from Michael Hartl&#39;s Rails Tutorial
</span>  <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z</span><span class='regexp_end'>/i</span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:email</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>format:</span> <span class='lbrace'>{</span> <span class='label'>with:</span> <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>uniqueness:</span> <span class='kw'>true</span>

  <span class='id identifier rubyid_has_secure_password'>has_secure_password</span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:password</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>length:</span> <span class='lbrace'>{</span> <span class='label'>minimum:</span> <span class='int'>6</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_has_one_attached'>has_one_attached</span> <span class='symbol'>:avatar</span>

  <span class='comment'># application relations
</span>  <span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:books</span><span class='comma'>,</span> <span class='label'>dependent:</span> <span class='symbol'>:destroy</span>

  <span class='comment'># scopes
</span>  <span class='comment'># all users but the one with a specific ID
</span>  <span class='id identifier rubyid_scope'>scope</span> <span class='symbol'>:all_but</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_where'>where</span><span class='period'>.</span><span class='id identifier rubyid_not'>not</span><span class='lparen'>(</span><span class='label'>id:</span> <span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

  <span class='comment'># returns the hash digest of the given string
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cost'>cost</span> <span class='op'>=</span> <span class='const'>ActiveModel</span><span class='op'>::</span><span class='const'>SecurePassword</span><span class='period'>.</span><span class='id identifier rubyid_min_cost'>min_cost</span> <span class='op'>?</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='op'>::</span><span class='const'>MIN_COST</span> <span class='op'>:</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='period'>.</span><span class='id identifier rubyid_cost'>cost</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='label'>cost:</span> <span class='id identifier rubyid_cost'>cost</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># we need an attribute &#39;remember_token&#39;, &#39;activation_token&#39; and &#39;reset_token&#39; to store the token
</span>  <span class='comment'># this line smells of :reek:Attribute
</span>  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:remember_token</span><span class='comma'>,</span> <span class='symbol'>:activation_token</span><span class='comma'>,</span> <span class='symbol'>:reset_token</span>

  <span class='comment'># convert e-mail address to lowercase before saving
</span>  <span class='id identifier rubyid_before_save'>before_save</span> <span class='symbol'>:downcase_email</span>
  <span class='comment'># automatically create an activation digest
</span>  <span class='id identifier rubyid_before_create'>before_create</span> <span class='symbol'>:create_activation_digest</span>

  <span class='comment'># returns a random token.
</span>  <span class='comment'># this is a CLASS method
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_urlsafe_base64'>urlsafe_base64</span>
  <span class='kw'>end</span>

  <span class='comment'># Remembers a user in the database for use in persistent sessions
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_remember'>remember</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_remember_token'>remember_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_remember_token'>remember_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_remember_digest'>remember_digest</span>
  <span class='kw'>end</span>

  <span class='comment'># forgets a user
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_forget'>forget</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># returns true if the given token matches the digest
</span>  <span class='comment'># this method smells of :reek:NilCheck
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_authenticated?'>authenticated?</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_digest'>digest</span> <span class='op'>=</span> <span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_attribute'>attribute</span><span class='embexpr_end'>}</span><span class='tstring_content'>_digest</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_digest'>digest</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_digest'>digest</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_is_password?'>is_password?</span><span class='lparen'>(</span><span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># returns a session token to prevent session hijacking
</span>  <span class='comment'># we reuse the remember digest for convenience
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_session_token'>session_token</span>
    <span class='id identifier rubyid_remember_digest'>remember_digest</span> <span class='op'>||</span> <span class='id identifier rubyid_remember'>remember</span>
  <span class='kw'>end</span>

  <span class='comment'># activates an account
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_activate'>activate</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends an activation e-mail
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_activation_email'>send_activation_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_account_activation'><span class='object_link'><a href="UserMailer.html#account_activation-instance_method" title="UserMailer#account_activation (method)">account_activation</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># sets password reset attributes
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_reset_digest'>create_reset_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset_token'>reset_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_reset_token'>reset_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_sent_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends password reset email
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_password_reset_email'>send_password_reset_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_password_reset'><span class='object_link'><a href="UserMailer.html#password_reset-instance_method" title="UserMailer#password_reset (method)">password_reset</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># returns true if a password reset has expired
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_password_reset_expired?'>password_reset_expired?</span>
    <span class='id identifier rubyid_reset_sent_at'>reset_sent_at</span> <span class='op'>&lt;</span> <span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_hours'>hours</span><span class='period'>.</span><span class='id identifier rubyid_ago'>ago</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># convert email to all lowercase
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_downcase_email'>downcase_email</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span> <span class='op'>=</span> <span class='id identifier rubyid_email'>email</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
  <span class='kw'>end</span>

  <span class='comment'># creates and assignes the activation token and digest
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_activation_digest'>create_activation_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_token'>activation_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_digest'>activation_digest</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_activation_token'>activation_token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="activation_token=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="activation_token-instance_method">
  
    #<strong>activation_token</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>we need an attribute ‘remember_token’, ‘activation_token’ and ‘reset_token’ to store the token this line smells of :reek:Attribute</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


64
65
66</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 64</span>

<span class='kw'>def</span> <span class='id identifier rubyid_activation_token'>activation_token</span>
  <span class='ivar'>@activation_token</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="admin=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="admin-instance_method">
  
    #<strong>admin</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 38</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="ApplicationRecord.html" title="ApplicationRecord (class)">ApplicationRecord</a></span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span>
  <span class='comment'># this is from Michael Hartl&#39;s Rails Tutorial
</span>  <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z</span><span class='regexp_end'>/i</span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:email</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>format:</span> <span class='lbrace'>{</span> <span class='label'>with:</span> <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>uniqueness:</span> <span class='kw'>true</span>

  <span class='id identifier rubyid_has_secure_password'>has_secure_password</span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:password</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>length:</span> <span class='lbrace'>{</span> <span class='label'>minimum:</span> <span class='int'>6</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_has_one_attached'>has_one_attached</span> <span class='symbol'>:avatar</span>

  <span class='comment'># application relations
</span>  <span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:books</span><span class='comma'>,</span> <span class='label'>dependent:</span> <span class='symbol'>:destroy</span>

  <span class='comment'># scopes
</span>  <span class='comment'># all users but the one with a specific ID
</span>  <span class='id identifier rubyid_scope'>scope</span> <span class='symbol'>:all_but</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_where'>where</span><span class='period'>.</span><span class='id identifier rubyid_not'>not</span><span class='lparen'>(</span><span class='label'>id:</span> <span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

  <span class='comment'># returns the hash digest of the given string
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cost'>cost</span> <span class='op'>=</span> <span class='const'>ActiveModel</span><span class='op'>::</span><span class='const'>SecurePassword</span><span class='period'>.</span><span class='id identifier rubyid_min_cost'>min_cost</span> <span class='op'>?</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='op'>::</span><span class='const'>MIN_COST</span> <span class='op'>:</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='period'>.</span><span class='id identifier rubyid_cost'>cost</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='label'>cost:</span> <span class='id identifier rubyid_cost'>cost</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># we need an attribute &#39;remember_token&#39;, &#39;activation_token&#39; and &#39;reset_token&#39; to store the token
</span>  <span class='comment'># this line smells of :reek:Attribute
</span>  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:remember_token</span><span class='comma'>,</span> <span class='symbol'>:activation_token</span><span class='comma'>,</span> <span class='symbol'>:reset_token</span>

  <span class='comment'># convert e-mail address to lowercase before saving
</span>  <span class='id identifier rubyid_before_save'>before_save</span> <span class='symbol'>:downcase_email</span>
  <span class='comment'># automatically create an activation digest
</span>  <span class='id identifier rubyid_before_create'>before_create</span> <span class='symbol'>:create_activation_digest</span>

  <span class='comment'># returns a random token.
</span>  <span class='comment'># this is a CLASS method
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_urlsafe_base64'>urlsafe_base64</span>
  <span class='kw'>end</span>

  <span class='comment'># Remembers a user in the database for use in persistent sessions
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_remember'>remember</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_remember_token'>remember_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_remember_token'>remember_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_remember_digest'>remember_digest</span>
  <span class='kw'>end</span>

  <span class='comment'># forgets a user
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_forget'>forget</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># returns true if the given token matches the digest
</span>  <span class='comment'># this method smells of :reek:NilCheck
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_authenticated?'>authenticated?</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_digest'>digest</span> <span class='op'>=</span> <span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_attribute'>attribute</span><span class='embexpr_end'>}</span><span class='tstring_content'>_digest</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_digest'>digest</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_digest'>digest</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_is_password?'>is_password?</span><span class='lparen'>(</span><span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># returns a session token to prevent session hijacking
</span>  <span class='comment'># we reuse the remember digest for convenience
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_session_token'>session_token</span>
    <span class='id identifier rubyid_remember_digest'>remember_digest</span> <span class='op'>||</span> <span class='id identifier rubyid_remember'>remember</span>
  <span class='kw'>end</span>

  <span class='comment'># activates an account
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_activate'>activate</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends an activation e-mail
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_activation_email'>send_activation_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_account_activation'><span class='object_link'><a href="UserMailer.html#account_activation-instance_method" title="UserMailer#account_activation (method)">account_activation</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># sets password reset attributes
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_reset_digest'>create_reset_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset_token'>reset_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_reset_token'>reset_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_sent_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends password reset email
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_password_reset_email'>send_password_reset_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_password_reset'><span class='object_link'><a href="UserMailer.html#password_reset-instance_method" title="UserMailer#password_reset (method)">password_reset</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># returns true if a password reset has expired
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_password_reset_expired?'>password_reset_expired?</span>
    <span class='id identifier rubyid_reset_sent_at'>reset_sent_at</span> <span class='op'>&lt;</span> <span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_hours'>hours</span><span class='period'>.</span><span class='id identifier rubyid_ago'>ago</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># convert email to all lowercase
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_downcase_email'>downcase_email</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span> <span class='op'>=</span> <span class='id identifier rubyid_email'>email</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
  <span class='kw'>end</span>

  <span class='comment'># creates and assignes the activation token and digest
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_activation_digest'>create_activation_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_token'>activation_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_digest'>activation_digest</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_activation_token'>activation_token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="created_at=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="created_at-instance_method">
  
    #<strong>created_at</strong>  &#x21d2; <tt>Time</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Time</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 38</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="ApplicationRecord.html" title="ApplicationRecord (class)">ApplicationRecord</a></span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span>
  <span class='comment'># this is from Michael Hartl&#39;s Rails Tutorial
</span>  <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z</span><span class='regexp_end'>/i</span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:email</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>format:</span> <span class='lbrace'>{</span> <span class='label'>with:</span> <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>uniqueness:</span> <span class='kw'>true</span>

  <span class='id identifier rubyid_has_secure_password'>has_secure_password</span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:password</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>length:</span> <span class='lbrace'>{</span> <span class='label'>minimum:</span> <span class='int'>6</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_has_one_attached'>has_one_attached</span> <span class='symbol'>:avatar</span>

  <span class='comment'># application relations
</span>  <span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:books</span><span class='comma'>,</span> <span class='label'>dependent:</span> <span class='symbol'>:destroy</span>

  <span class='comment'># scopes
</span>  <span class='comment'># all users but the one with a specific ID
</span>  <span class='id identifier rubyid_scope'>scope</span> <span class='symbol'>:all_but</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_where'>where</span><span class='period'>.</span><span class='id identifier rubyid_not'>not</span><span class='lparen'>(</span><span class='label'>id:</span> <span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

  <span class='comment'># returns the hash digest of the given string
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cost'>cost</span> <span class='op'>=</span> <span class='const'>ActiveModel</span><span class='op'>::</span><span class='const'>SecurePassword</span><span class='period'>.</span><span class='id identifier rubyid_min_cost'>min_cost</span> <span class='op'>?</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='op'>::</span><span class='const'>MIN_COST</span> <span class='op'>:</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='period'>.</span><span class='id identifier rubyid_cost'>cost</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='label'>cost:</span> <span class='id identifier rubyid_cost'>cost</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># we need an attribute &#39;remember_token&#39;, &#39;activation_token&#39; and &#39;reset_token&#39; to store the token
</span>  <span class='comment'># this line smells of :reek:Attribute
</span>  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:remember_token</span><span class='comma'>,</span> <span class='symbol'>:activation_token</span><span class='comma'>,</span> <span class='symbol'>:reset_token</span>

  <span class='comment'># convert e-mail address to lowercase before saving
</span>  <span class='id identifier rubyid_before_save'>before_save</span> <span class='symbol'>:downcase_email</span>
  <span class='comment'># automatically create an activation digest
</span>  <span class='id identifier rubyid_before_create'>before_create</span> <span class='symbol'>:create_activation_digest</span>

  <span class='comment'># returns a random token.
</span>  <span class='comment'># this is a CLASS method
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_urlsafe_base64'>urlsafe_base64</span>
  <span class='kw'>end</span>

  <span class='comment'># Remembers a user in the database for use in persistent sessions
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_remember'>remember</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_remember_token'>remember_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_remember_token'>remember_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_remember_digest'>remember_digest</span>
  <span class='kw'>end</span>

  <span class='comment'># forgets a user
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_forget'>forget</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># returns true if the given token matches the digest
</span>  <span class='comment'># this method smells of :reek:NilCheck
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_authenticated?'>authenticated?</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_digest'>digest</span> <span class='op'>=</span> <span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_attribute'>attribute</span><span class='embexpr_end'>}</span><span class='tstring_content'>_digest</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_digest'>digest</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_digest'>digest</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_is_password?'>is_password?</span><span class='lparen'>(</span><span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># returns a session token to prevent session hijacking
</span>  <span class='comment'># we reuse the remember digest for convenience
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_session_token'>session_token</span>
    <span class='id identifier rubyid_remember_digest'>remember_digest</span> <span class='op'>||</span> <span class='id identifier rubyid_remember'>remember</span>
  <span class='kw'>end</span>

  <span class='comment'># activates an account
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_activate'>activate</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends an activation e-mail
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_activation_email'>send_activation_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_account_activation'><span class='object_link'><a href="UserMailer.html#account_activation-instance_method" title="UserMailer#account_activation (method)">account_activation</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># sets password reset attributes
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_reset_digest'>create_reset_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset_token'>reset_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_reset_token'>reset_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_sent_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends password reset email
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_password_reset_email'>send_password_reset_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_password_reset'><span class='object_link'><a href="UserMailer.html#password_reset-instance_method" title="UserMailer#password_reset (method)">password_reset</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># returns true if a password reset has expired
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_password_reset_expired?'>password_reset_expired?</span>
    <span class='id identifier rubyid_reset_sent_at'>reset_sent_at</span> <span class='op'>&lt;</span> <span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_hours'>hours</span><span class='period'>.</span><span class='id identifier rubyid_ago'>ago</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># convert email to all lowercase
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_downcase_email'>downcase_email</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span> <span class='op'>=</span> <span class='id identifier rubyid_email'>email</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
  <span class='kw'>end</span>

  <span class='comment'># creates and assignes the activation token and digest
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_activation_digest'>create_activation_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_token'>activation_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_digest'>activation_digest</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_activation_token'>activation_token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="email=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="email-instance_method">
  
    #<strong>email</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 38</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="ApplicationRecord.html" title="ApplicationRecord (class)">ApplicationRecord</a></span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span>
  <span class='comment'># this is from Michael Hartl&#39;s Rails Tutorial
</span>  <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z</span><span class='regexp_end'>/i</span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:email</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>format:</span> <span class='lbrace'>{</span> <span class='label'>with:</span> <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>uniqueness:</span> <span class='kw'>true</span>

  <span class='id identifier rubyid_has_secure_password'>has_secure_password</span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:password</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>length:</span> <span class='lbrace'>{</span> <span class='label'>minimum:</span> <span class='int'>6</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_has_one_attached'>has_one_attached</span> <span class='symbol'>:avatar</span>

  <span class='comment'># application relations
</span>  <span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:books</span><span class='comma'>,</span> <span class='label'>dependent:</span> <span class='symbol'>:destroy</span>

  <span class='comment'># scopes
</span>  <span class='comment'># all users but the one with a specific ID
</span>  <span class='id identifier rubyid_scope'>scope</span> <span class='symbol'>:all_but</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_where'>where</span><span class='period'>.</span><span class='id identifier rubyid_not'>not</span><span class='lparen'>(</span><span class='label'>id:</span> <span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

  <span class='comment'># returns the hash digest of the given string
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cost'>cost</span> <span class='op'>=</span> <span class='const'>ActiveModel</span><span class='op'>::</span><span class='const'>SecurePassword</span><span class='period'>.</span><span class='id identifier rubyid_min_cost'>min_cost</span> <span class='op'>?</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='op'>::</span><span class='const'>MIN_COST</span> <span class='op'>:</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='period'>.</span><span class='id identifier rubyid_cost'>cost</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='label'>cost:</span> <span class='id identifier rubyid_cost'>cost</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># we need an attribute &#39;remember_token&#39;, &#39;activation_token&#39; and &#39;reset_token&#39; to store the token
</span>  <span class='comment'># this line smells of :reek:Attribute
</span>  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:remember_token</span><span class='comma'>,</span> <span class='symbol'>:activation_token</span><span class='comma'>,</span> <span class='symbol'>:reset_token</span>

  <span class='comment'># convert e-mail address to lowercase before saving
</span>  <span class='id identifier rubyid_before_save'>before_save</span> <span class='symbol'>:downcase_email</span>
  <span class='comment'># automatically create an activation digest
</span>  <span class='id identifier rubyid_before_create'>before_create</span> <span class='symbol'>:create_activation_digest</span>

  <span class='comment'># returns a random token.
</span>  <span class='comment'># this is a CLASS method
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_urlsafe_base64'>urlsafe_base64</span>
  <span class='kw'>end</span>

  <span class='comment'># Remembers a user in the database for use in persistent sessions
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_remember'>remember</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_remember_token'>remember_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_remember_token'>remember_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_remember_digest'>remember_digest</span>
  <span class='kw'>end</span>

  <span class='comment'># forgets a user
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_forget'>forget</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># returns true if the given token matches the digest
</span>  <span class='comment'># this method smells of :reek:NilCheck
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_authenticated?'>authenticated?</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_digest'>digest</span> <span class='op'>=</span> <span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_attribute'>attribute</span><span class='embexpr_end'>}</span><span class='tstring_content'>_digest</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_digest'>digest</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_digest'>digest</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_is_password?'>is_password?</span><span class='lparen'>(</span><span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># returns a session token to prevent session hijacking
</span>  <span class='comment'># we reuse the remember digest for convenience
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_session_token'>session_token</span>
    <span class='id identifier rubyid_remember_digest'>remember_digest</span> <span class='op'>||</span> <span class='id identifier rubyid_remember'>remember</span>
  <span class='kw'>end</span>

  <span class='comment'># activates an account
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_activate'>activate</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends an activation e-mail
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_activation_email'>send_activation_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_account_activation'><span class='object_link'><a href="UserMailer.html#account_activation-instance_method" title="UserMailer#account_activation (method)">account_activation</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># sets password reset attributes
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_reset_digest'>create_reset_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset_token'>reset_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_reset_token'>reset_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_sent_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends password reset email
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_password_reset_email'>send_password_reset_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_password_reset'><span class='object_link'><a href="UserMailer.html#password_reset-instance_method" title="UserMailer#password_reset (method)">password_reset</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># returns true if a password reset has expired
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_password_reset_expired?'>password_reset_expired?</span>
    <span class='id identifier rubyid_reset_sent_at'>reset_sent_at</span> <span class='op'>&lt;</span> <span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_hours'>hours</span><span class='period'>.</span><span class='id identifier rubyid_ago'>ago</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># convert email to all lowercase
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_downcase_email'>downcase_email</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span> <span class='op'>=</span> <span class='id identifier rubyid_email'>email</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
  <span class='kw'>end</span>

  <span class='comment'># creates and assignes the activation token and digest
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_activation_digest'>create_activation_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_token'>activation_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_digest'>activation_digest</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_activation_token'>activation_token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="id=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="id-instance_method">
  
    #<strong>id</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns [].</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><dl class="rdoc-list label-list"><dt>
<dd></dd></dl>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 38</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="ApplicationRecord.html" title="ApplicationRecord (class)">ApplicationRecord</a></span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span>
  <span class='comment'># this is from Michael Hartl&#39;s Rails Tutorial
</span>  <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z</span><span class='regexp_end'>/i</span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:email</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>format:</span> <span class='lbrace'>{</span> <span class='label'>with:</span> <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>uniqueness:</span> <span class='kw'>true</span>

  <span class='id identifier rubyid_has_secure_password'>has_secure_password</span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:password</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>length:</span> <span class='lbrace'>{</span> <span class='label'>minimum:</span> <span class='int'>6</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_has_one_attached'>has_one_attached</span> <span class='symbol'>:avatar</span>

  <span class='comment'># application relations
</span>  <span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:books</span><span class='comma'>,</span> <span class='label'>dependent:</span> <span class='symbol'>:destroy</span>

  <span class='comment'># scopes
</span>  <span class='comment'># all users but the one with a specific ID
</span>  <span class='id identifier rubyid_scope'>scope</span> <span class='symbol'>:all_but</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_where'>where</span><span class='period'>.</span><span class='id identifier rubyid_not'>not</span><span class='lparen'>(</span><span class='label'>id:</span> <span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

  <span class='comment'># returns the hash digest of the given string
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cost'>cost</span> <span class='op'>=</span> <span class='const'>ActiveModel</span><span class='op'>::</span><span class='const'>SecurePassword</span><span class='period'>.</span><span class='id identifier rubyid_min_cost'>min_cost</span> <span class='op'>?</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='op'>::</span><span class='const'>MIN_COST</span> <span class='op'>:</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='period'>.</span><span class='id identifier rubyid_cost'>cost</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='label'>cost:</span> <span class='id identifier rubyid_cost'>cost</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># we need an attribute &#39;remember_token&#39;, &#39;activation_token&#39; and &#39;reset_token&#39; to store the token
</span>  <span class='comment'># this line smells of :reek:Attribute
</span>  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:remember_token</span><span class='comma'>,</span> <span class='symbol'>:activation_token</span><span class='comma'>,</span> <span class='symbol'>:reset_token</span>

  <span class='comment'># convert e-mail address to lowercase before saving
</span>  <span class='id identifier rubyid_before_save'>before_save</span> <span class='symbol'>:downcase_email</span>
  <span class='comment'># automatically create an activation digest
</span>  <span class='id identifier rubyid_before_create'>before_create</span> <span class='symbol'>:create_activation_digest</span>

  <span class='comment'># returns a random token.
</span>  <span class='comment'># this is a CLASS method
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_urlsafe_base64'>urlsafe_base64</span>
  <span class='kw'>end</span>

  <span class='comment'># Remembers a user in the database for use in persistent sessions
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_remember'>remember</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_remember_token'>remember_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_remember_token'>remember_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_remember_digest'>remember_digest</span>
  <span class='kw'>end</span>

  <span class='comment'># forgets a user
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_forget'>forget</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># returns true if the given token matches the digest
</span>  <span class='comment'># this method smells of :reek:NilCheck
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_authenticated?'>authenticated?</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_digest'>digest</span> <span class='op'>=</span> <span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_attribute'>attribute</span><span class='embexpr_end'>}</span><span class='tstring_content'>_digest</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_digest'>digest</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_digest'>digest</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_is_password?'>is_password?</span><span class='lparen'>(</span><span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># returns a session token to prevent session hijacking
</span>  <span class='comment'># we reuse the remember digest for convenience
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_session_token'>session_token</span>
    <span class='id identifier rubyid_remember_digest'>remember_digest</span> <span class='op'>||</span> <span class='id identifier rubyid_remember'>remember</span>
  <span class='kw'>end</span>

  <span class='comment'># activates an account
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_activate'>activate</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends an activation e-mail
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_activation_email'>send_activation_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_account_activation'><span class='object_link'><a href="UserMailer.html#account_activation-instance_method" title="UserMailer#account_activation (method)">account_activation</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># sets password reset attributes
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_reset_digest'>create_reset_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset_token'>reset_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_reset_token'>reset_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_sent_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends password reset email
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_password_reset_email'>send_password_reset_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_password_reset'><span class='object_link'><a href="UserMailer.html#password_reset-instance_method" title="UserMailer#password_reset (method)">password_reset</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># returns true if a password reset has expired
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_password_reset_expired?'>password_reset_expired?</span>
    <span class='id identifier rubyid_reset_sent_at'>reset_sent_at</span> <span class='op'>&lt;</span> <span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_hours'>hours</span><span class='period'>.</span><span class='id identifier rubyid_ago'>ago</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># convert email to all lowercase
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_downcase_email'>downcase_email</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span> <span class='op'>=</span> <span class='id identifier rubyid_email'>email</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
  <span class='kw'>end</span>

  <span class='comment'># creates and assignes the activation token and digest
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_activation_digest'>create_activation_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_token'>activation_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_digest'>activation_digest</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_activation_token'>activation_token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="name=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="name-instance_method">
  
    #<strong>name</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 38</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="ApplicationRecord.html" title="ApplicationRecord (class)">ApplicationRecord</a></span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span>
  <span class='comment'># this is from Michael Hartl&#39;s Rails Tutorial
</span>  <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z</span><span class='regexp_end'>/i</span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:email</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>format:</span> <span class='lbrace'>{</span> <span class='label'>with:</span> <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>uniqueness:</span> <span class='kw'>true</span>

  <span class='id identifier rubyid_has_secure_password'>has_secure_password</span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:password</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>length:</span> <span class='lbrace'>{</span> <span class='label'>minimum:</span> <span class='int'>6</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_has_one_attached'>has_one_attached</span> <span class='symbol'>:avatar</span>

  <span class='comment'># application relations
</span>  <span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:books</span><span class='comma'>,</span> <span class='label'>dependent:</span> <span class='symbol'>:destroy</span>

  <span class='comment'># scopes
</span>  <span class='comment'># all users but the one with a specific ID
</span>  <span class='id identifier rubyid_scope'>scope</span> <span class='symbol'>:all_but</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_where'>where</span><span class='period'>.</span><span class='id identifier rubyid_not'>not</span><span class='lparen'>(</span><span class='label'>id:</span> <span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

  <span class='comment'># returns the hash digest of the given string
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cost'>cost</span> <span class='op'>=</span> <span class='const'>ActiveModel</span><span class='op'>::</span><span class='const'>SecurePassword</span><span class='period'>.</span><span class='id identifier rubyid_min_cost'>min_cost</span> <span class='op'>?</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='op'>::</span><span class='const'>MIN_COST</span> <span class='op'>:</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='period'>.</span><span class='id identifier rubyid_cost'>cost</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='label'>cost:</span> <span class='id identifier rubyid_cost'>cost</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># we need an attribute &#39;remember_token&#39;, &#39;activation_token&#39; and &#39;reset_token&#39; to store the token
</span>  <span class='comment'># this line smells of :reek:Attribute
</span>  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:remember_token</span><span class='comma'>,</span> <span class='symbol'>:activation_token</span><span class='comma'>,</span> <span class='symbol'>:reset_token</span>

  <span class='comment'># convert e-mail address to lowercase before saving
</span>  <span class='id identifier rubyid_before_save'>before_save</span> <span class='symbol'>:downcase_email</span>
  <span class='comment'># automatically create an activation digest
</span>  <span class='id identifier rubyid_before_create'>before_create</span> <span class='symbol'>:create_activation_digest</span>

  <span class='comment'># returns a random token.
</span>  <span class='comment'># this is a CLASS method
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_urlsafe_base64'>urlsafe_base64</span>
  <span class='kw'>end</span>

  <span class='comment'># Remembers a user in the database for use in persistent sessions
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_remember'>remember</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_remember_token'>remember_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_remember_token'>remember_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_remember_digest'>remember_digest</span>
  <span class='kw'>end</span>

  <span class='comment'># forgets a user
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_forget'>forget</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># returns true if the given token matches the digest
</span>  <span class='comment'># this method smells of :reek:NilCheck
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_authenticated?'>authenticated?</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_digest'>digest</span> <span class='op'>=</span> <span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_attribute'>attribute</span><span class='embexpr_end'>}</span><span class='tstring_content'>_digest</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_digest'>digest</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_digest'>digest</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_is_password?'>is_password?</span><span class='lparen'>(</span><span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># returns a session token to prevent session hijacking
</span>  <span class='comment'># we reuse the remember digest for convenience
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_session_token'>session_token</span>
    <span class='id identifier rubyid_remember_digest'>remember_digest</span> <span class='op'>||</span> <span class='id identifier rubyid_remember'>remember</span>
  <span class='kw'>end</span>

  <span class='comment'># activates an account
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_activate'>activate</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends an activation e-mail
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_activation_email'>send_activation_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_account_activation'><span class='object_link'><a href="UserMailer.html#account_activation-instance_method" title="UserMailer#account_activation (method)">account_activation</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># sets password reset attributes
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_reset_digest'>create_reset_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset_token'>reset_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_reset_token'>reset_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_sent_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends password reset email
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_password_reset_email'>send_password_reset_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_password_reset'><span class='object_link'><a href="UserMailer.html#password_reset-instance_method" title="UserMailer#password_reset (method)">password_reset</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># returns true if a password reset has expired
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_password_reset_expired?'>password_reset_expired?</span>
    <span class='id identifier rubyid_reset_sent_at'>reset_sent_at</span> <span class='op'>&lt;</span> <span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_hours'>hours</span><span class='period'>.</span><span class='id identifier rubyid_ago'>ago</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># convert email to all lowercase
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_downcase_email'>downcase_email</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span> <span class='op'>=</span> <span class='id identifier rubyid_email'>email</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
  <span class='kw'>end</span>

  <span class='comment'># creates and assignes the activation token and digest
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_activation_digest'>create_activation_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_token'>activation_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_digest'>activation_digest</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_activation_token'>activation_token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="password_digest=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="password_digest-instance_method">
  
    #<strong>password_digest</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 38</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="ApplicationRecord.html" title="ApplicationRecord (class)">ApplicationRecord</a></span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span>
  <span class='comment'># this is from Michael Hartl&#39;s Rails Tutorial
</span>  <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z</span><span class='regexp_end'>/i</span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:email</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>format:</span> <span class='lbrace'>{</span> <span class='label'>with:</span> <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>uniqueness:</span> <span class='kw'>true</span>

  <span class='id identifier rubyid_has_secure_password'>has_secure_password</span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:password</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>length:</span> <span class='lbrace'>{</span> <span class='label'>minimum:</span> <span class='int'>6</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_has_one_attached'>has_one_attached</span> <span class='symbol'>:avatar</span>

  <span class='comment'># application relations
</span>  <span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:books</span><span class='comma'>,</span> <span class='label'>dependent:</span> <span class='symbol'>:destroy</span>

  <span class='comment'># scopes
</span>  <span class='comment'># all users but the one with a specific ID
</span>  <span class='id identifier rubyid_scope'>scope</span> <span class='symbol'>:all_but</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_where'>where</span><span class='period'>.</span><span class='id identifier rubyid_not'>not</span><span class='lparen'>(</span><span class='label'>id:</span> <span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

  <span class='comment'># returns the hash digest of the given string
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cost'>cost</span> <span class='op'>=</span> <span class='const'>ActiveModel</span><span class='op'>::</span><span class='const'>SecurePassword</span><span class='period'>.</span><span class='id identifier rubyid_min_cost'>min_cost</span> <span class='op'>?</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='op'>::</span><span class='const'>MIN_COST</span> <span class='op'>:</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='period'>.</span><span class='id identifier rubyid_cost'>cost</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='label'>cost:</span> <span class='id identifier rubyid_cost'>cost</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># we need an attribute &#39;remember_token&#39;, &#39;activation_token&#39; and &#39;reset_token&#39; to store the token
</span>  <span class='comment'># this line smells of :reek:Attribute
</span>  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:remember_token</span><span class='comma'>,</span> <span class='symbol'>:activation_token</span><span class='comma'>,</span> <span class='symbol'>:reset_token</span>

  <span class='comment'># convert e-mail address to lowercase before saving
</span>  <span class='id identifier rubyid_before_save'>before_save</span> <span class='symbol'>:downcase_email</span>
  <span class='comment'># automatically create an activation digest
</span>  <span class='id identifier rubyid_before_create'>before_create</span> <span class='symbol'>:create_activation_digest</span>

  <span class='comment'># returns a random token.
</span>  <span class='comment'># this is a CLASS method
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_urlsafe_base64'>urlsafe_base64</span>
  <span class='kw'>end</span>

  <span class='comment'># Remembers a user in the database for use in persistent sessions
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_remember'>remember</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_remember_token'>remember_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_remember_token'>remember_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_remember_digest'>remember_digest</span>
  <span class='kw'>end</span>

  <span class='comment'># forgets a user
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_forget'>forget</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># returns true if the given token matches the digest
</span>  <span class='comment'># this method smells of :reek:NilCheck
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_authenticated?'>authenticated?</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_digest'>digest</span> <span class='op'>=</span> <span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_attribute'>attribute</span><span class='embexpr_end'>}</span><span class='tstring_content'>_digest</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_digest'>digest</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_digest'>digest</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_is_password?'>is_password?</span><span class='lparen'>(</span><span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># returns a session token to prevent session hijacking
</span>  <span class='comment'># we reuse the remember digest for convenience
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_session_token'>session_token</span>
    <span class='id identifier rubyid_remember_digest'>remember_digest</span> <span class='op'>||</span> <span class='id identifier rubyid_remember'>remember</span>
  <span class='kw'>end</span>

  <span class='comment'># activates an account
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_activate'>activate</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends an activation e-mail
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_activation_email'>send_activation_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_account_activation'><span class='object_link'><a href="UserMailer.html#account_activation-instance_method" title="UserMailer#account_activation (method)">account_activation</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># sets password reset attributes
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_reset_digest'>create_reset_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset_token'>reset_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_reset_token'>reset_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_sent_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends password reset email
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_password_reset_email'>send_password_reset_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_password_reset'><span class='object_link'><a href="UserMailer.html#password_reset-instance_method" title="UserMailer#password_reset (method)">password_reset</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># returns true if a password reset has expired
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_password_reset_expired?'>password_reset_expired?</span>
    <span class='id identifier rubyid_reset_sent_at'>reset_sent_at</span> <span class='op'>&lt;</span> <span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_hours'>hours</span><span class='period'>.</span><span class='id identifier rubyid_ago'>ago</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># convert email to all lowercase
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_downcase_email'>downcase_email</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span> <span class='op'>=</span> <span class='id identifier rubyid_email'>email</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
  <span class='kw'>end</span>

  <span class='comment'># creates and assignes the activation token and digest
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_activation_digest'>create_activation_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_token'>activation_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_digest'>activation_digest</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_activation_token'>activation_token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="remember_digest=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="remember_digest-instance_method">
  
    #<strong>remember_digest</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 38</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="ApplicationRecord.html" title="ApplicationRecord (class)">ApplicationRecord</a></span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span>
  <span class='comment'># this is from Michael Hartl&#39;s Rails Tutorial
</span>  <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z</span><span class='regexp_end'>/i</span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:email</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>format:</span> <span class='lbrace'>{</span> <span class='label'>with:</span> <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>uniqueness:</span> <span class='kw'>true</span>

  <span class='id identifier rubyid_has_secure_password'>has_secure_password</span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:password</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>length:</span> <span class='lbrace'>{</span> <span class='label'>minimum:</span> <span class='int'>6</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_has_one_attached'>has_one_attached</span> <span class='symbol'>:avatar</span>

  <span class='comment'># application relations
</span>  <span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:books</span><span class='comma'>,</span> <span class='label'>dependent:</span> <span class='symbol'>:destroy</span>

  <span class='comment'># scopes
</span>  <span class='comment'># all users but the one with a specific ID
</span>  <span class='id identifier rubyid_scope'>scope</span> <span class='symbol'>:all_but</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_where'>where</span><span class='period'>.</span><span class='id identifier rubyid_not'>not</span><span class='lparen'>(</span><span class='label'>id:</span> <span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

  <span class='comment'># returns the hash digest of the given string
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cost'>cost</span> <span class='op'>=</span> <span class='const'>ActiveModel</span><span class='op'>::</span><span class='const'>SecurePassword</span><span class='period'>.</span><span class='id identifier rubyid_min_cost'>min_cost</span> <span class='op'>?</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='op'>::</span><span class='const'>MIN_COST</span> <span class='op'>:</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='period'>.</span><span class='id identifier rubyid_cost'>cost</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='label'>cost:</span> <span class='id identifier rubyid_cost'>cost</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># we need an attribute &#39;remember_token&#39;, &#39;activation_token&#39; and &#39;reset_token&#39; to store the token
</span>  <span class='comment'># this line smells of :reek:Attribute
</span>  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:remember_token</span><span class='comma'>,</span> <span class='symbol'>:activation_token</span><span class='comma'>,</span> <span class='symbol'>:reset_token</span>

  <span class='comment'># convert e-mail address to lowercase before saving
</span>  <span class='id identifier rubyid_before_save'>before_save</span> <span class='symbol'>:downcase_email</span>
  <span class='comment'># automatically create an activation digest
</span>  <span class='id identifier rubyid_before_create'>before_create</span> <span class='symbol'>:create_activation_digest</span>

  <span class='comment'># returns a random token.
</span>  <span class='comment'># this is a CLASS method
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_urlsafe_base64'>urlsafe_base64</span>
  <span class='kw'>end</span>

  <span class='comment'># Remembers a user in the database for use in persistent sessions
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_remember'>remember</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_remember_token'>remember_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_remember_token'>remember_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_remember_digest'>remember_digest</span>
  <span class='kw'>end</span>

  <span class='comment'># forgets a user
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_forget'>forget</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># returns true if the given token matches the digest
</span>  <span class='comment'># this method smells of :reek:NilCheck
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_authenticated?'>authenticated?</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_digest'>digest</span> <span class='op'>=</span> <span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_attribute'>attribute</span><span class='embexpr_end'>}</span><span class='tstring_content'>_digest</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_digest'>digest</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_digest'>digest</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_is_password?'>is_password?</span><span class='lparen'>(</span><span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># returns a session token to prevent session hijacking
</span>  <span class='comment'># we reuse the remember digest for convenience
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_session_token'>session_token</span>
    <span class='id identifier rubyid_remember_digest'>remember_digest</span> <span class='op'>||</span> <span class='id identifier rubyid_remember'>remember</span>
  <span class='kw'>end</span>

  <span class='comment'># activates an account
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_activate'>activate</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends an activation e-mail
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_activation_email'>send_activation_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_account_activation'><span class='object_link'><a href="UserMailer.html#account_activation-instance_method" title="UserMailer#account_activation (method)">account_activation</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># sets password reset attributes
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_reset_digest'>create_reset_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset_token'>reset_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_reset_token'>reset_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_sent_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends password reset email
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_password_reset_email'>send_password_reset_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_password_reset'><span class='object_link'><a href="UserMailer.html#password_reset-instance_method" title="UserMailer#password_reset (method)">password_reset</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># returns true if a password reset has expired
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_password_reset_expired?'>password_reset_expired?</span>
    <span class='id identifier rubyid_reset_sent_at'>reset_sent_at</span> <span class='op'>&lt;</span> <span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_hours'>hours</span><span class='period'>.</span><span class='id identifier rubyid_ago'>ago</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># convert email to all lowercase
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_downcase_email'>downcase_email</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span> <span class='op'>=</span> <span class='id identifier rubyid_email'>email</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
  <span class='kw'>end</span>

  <span class='comment'># creates and assignes the activation token and digest
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_activation_digest'>create_activation_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_token'>activation_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_digest'>activation_digest</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_activation_token'>activation_token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="remember_token=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="remember_token-instance_method">
  
    #<strong>remember_token</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>we need an attribute ‘remember_token’, ‘activation_token’ and ‘reset_token’ to store the token this line smells of :reek:Attribute</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


64
65
66</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 64</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remember_token'>remember_token</span>
  <span class='ivar'>@remember_token</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="reset_digest=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="reset_digest-instance_method">
  
    #<strong>reset_digest</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 38</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="ApplicationRecord.html" title="ApplicationRecord (class)">ApplicationRecord</a></span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span>
  <span class='comment'># this is from Michael Hartl&#39;s Rails Tutorial
</span>  <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z</span><span class='regexp_end'>/i</span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:email</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>format:</span> <span class='lbrace'>{</span> <span class='label'>with:</span> <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>uniqueness:</span> <span class='kw'>true</span>

  <span class='id identifier rubyid_has_secure_password'>has_secure_password</span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:password</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>length:</span> <span class='lbrace'>{</span> <span class='label'>minimum:</span> <span class='int'>6</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_has_one_attached'>has_one_attached</span> <span class='symbol'>:avatar</span>

  <span class='comment'># application relations
</span>  <span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:books</span><span class='comma'>,</span> <span class='label'>dependent:</span> <span class='symbol'>:destroy</span>

  <span class='comment'># scopes
</span>  <span class='comment'># all users but the one with a specific ID
</span>  <span class='id identifier rubyid_scope'>scope</span> <span class='symbol'>:all_but</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_where'>where</span><span class='period'>.</span><span class='id identifier rubyid_not'>not</span><span class='lparen'>(</span><span class='label'>id:</span> <span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

  <span class='comment'># returns the hash digest of the given string
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cost'>cost</span> <span class='op'>=</span> <span class='const'>ActiveModel</span><span class='op'>::</span><span class='const'>SecurePassword</span><span class='period'>.</span><span class='id identifier rubyid_min_cost'>min_cost</span> <span class='op'>?</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='op'>::</span><span class='const'>MIN_COST</span> <span class='op'>:</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='period'>.</span><span class='id identifier rubyid_cost'>cost</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='label'>cost:</span> <span class='id identifier rubyid_cost'>cost</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># we need an attribute &#39;remember_token&#39;, &#39;activation_token&#39; and &#39;reset_token&#39; to store the token
</span>  <span class='comment'># this line smells of :reek:Attribute
</span>  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:remember_token</span><span class='comma'>,</span> <span class='symbol'>:activation_token</span><span class='comma'>,</span> <span class='symbol'>:reset_token</span>

  <span class='comment'># convert e-mail address to lowercase before saving
</span>  <span class='id identifier rubyid_before_save'>before_save</span> <span class='symbol'>:downcase_email</span>
  <span class='comment'># automatically create an activation digest
</span>  <span class='id identifier rubyid_before_create'>before_create</span> <span class='symbol'>:create_activation_digest</span>

  <span class='comment'># returns a random token.
</span>  <span class='comment'># this is a CLASS method
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_urlsafe_base64'>urlsafe_base64</span>
  <span class='kw'>end</span>

  <span class='comment'># Remembers a user in the database for use in persistent sessions
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_remember'>remember</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_remember_token'>remember_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_remember_token'>remember_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_remember_digest'>remember_digest</span>
  <span class='kw'>end</span>

  <span class='comment'># forgets a user
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_forget'>forget</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># returns true if the given token matches the digest
</span>  <span class='comment'># this method smells of :reek:NilCheck
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_authenticated?'>authenticated?</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_digest'>digest</span> <span class='op'>=</span> <span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_attribute'>attribute</span><span class='embexpr_end'>}</span><span class='tstring_content'>_digest</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_digest'>digest</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_digest'>digest</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_is_password?'>is_password?</span><span class='lparen'>(</span><span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># returns a session token to prevent session hijacking
</span>  <span class='comment'># we reuse the remember digest for convenience
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_session_token'>session_token</span>
    <span class='id identifier rubyid_remember_digest'>remember_digest</span> <span class='op'>||</span> <span class='id identifier rubyid_remember'>remember</span>
  <span class='kw'>end</span>

  <span class='comment'># activates an account
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_activate'>activate</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends an activation e-mail
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_activation_email'>send_activation_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_account_activation'><span class='object_link'><a href="UserMailer.html#account_activation-instance_method" title="UserMailer#account_activation (method)">account_activation</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># sets password reset attributes
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_reset_digest'>create_reset_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset_token'>reset_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_reset_token'>reset_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_sent_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends password reset email
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_password_reset_email'>send_password_reset_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_password_reset'><span class='object_link'><a href="UserMailer.html#password_reset-instance_method" title="UserMailer#password_reset (method)">password_reset</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># returns true if a password reset has expired
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_password_reset_expired?'>password_reset_expired?</span>
    <span class='id identifier rubyid_reset_sent_at'>reset_sent_at</span> <span class='op'>&lt;</span> <span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_hours'>hours</span><span class='period'>.</span><span class='id identifier rubyid_ago'>ago</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># convert email to all lowercase
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_downcase_email'>downcase_email</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span> <span class='op'>=</span> <span class='id identifier rubyid_email'>email</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
  <span class='kw'>end</span>

  <span class='comment'># creates and assignes the activation token and digest
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_activation_digest'>create_activation_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_token'>activation_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_digest'>activation_digest</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_activation_token'>activation_token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="reset_sent_at=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="reset_sent_at-instance_method">
  
    #<strong>reset_sent_at</strong>  &#x21d2; <tt>Time</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Time</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 38</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="ApplicationRecord.html" title="ApplicationRecord (class)">ApplicationRecord</a></span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span>
  <span class='comment'># this is from Michael Hartl&#39;s Rails Tutorial
</span>  <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z</span><span class='regexp_end'>/i</span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:email</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>format:</span> <span class='lbrace'>{</span> <span class='label'>with:</span> <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>uniqueness:</span> <span class='kw'>true</span>

  <span class='id identifier rubyid_has_secure_password'>has_secure_password</span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:password</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>length:</span> <span class='lbrace'>{</span> <span class='label'>minimum:</span> <span class='int'>6</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_has_one_attached'>has_one_attached</span> <span class='symbol'>:avatar</span>

  <span class='comment'># application relations
</span>  <span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:books</span><span class='comma'>,</span> <span class='label'>dependent:</span> <span class='symbol'>:destroy</span>

  <span class='comment'># scopes
</span>  <span class='comment'># all users but the one with a specific ID
</span>  <span class='id identifier rubyid_scope'>scope</span> <span class='symbol'>:all_but</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_where'>where</span><span class='period'>.</span><span class='id identifier rubyid_not'>not</span><span class='lparen'>(</span><span class='label'>id:</span> <span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

  <span class='comment'># returns the hash digest of the given string
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cost'>cost</span> <span class='op'>=</span> <span class='const'>ActiveModel</span><span class='op'>::</span><span class='const'>SecurePassword</span><span class='period'>.</span><span class='id identifier rubyid_min_cost'>min_cost</span> <span class='op'>?</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='op'>::</span><span class='const'>MIN_COST</span> <span class='op'>:</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='period'>.</span><span class='id identifier rubyid_cost'>cost</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='label'>cost:</span> <span class='id identifier rubyid_cost'>cost</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># we need an attribute &#39;remember_token&#39;, &#39;activation_token&#39; and &#39;reset_token&#39; to store the token
</span>  <span class='comment'># this line smells of :reek:Attribute
</span>  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:remember_token</span><span class='comma'>,</span> <span class='symbol'>:activation_token</span><span class='comma'>,</span> <span class='symbol'>:reset_token</span>

  <span class='comment'># convert e-mail address to lowercase before saving
</span>  <span class='id identifier rubyid_before_save'>before_save</span> <span class='symbol'>:downcase_email</span>
  <span class='comment'># automatically create an activation digest
</span>  <span class='id identifier rubyid_before_create'>before_create</span> <span class='symbol'>:create_activation_digest</span>

  <span class='comment'># returns a random token.
</span>  <span class='comment'># this is a CLASS method
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_urlsafe_base64'>urlsafe_base64</span>
  <span class='kw'>end</span>

  <span class='comment'># Remembers a user in the database for use in persistent sessions
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_remember'>remember</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_remember_token'>remember_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_remember_token'>remember_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_remember_digest'>remember_digest</span>
  <span class='kw'>end</span>

  <span class='comment'># forgets a user
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_forget'>forget</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># returns true if the given token matches the digest
</span>  <span class='comment'># this method smells of :reek:NilCheck
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_authenticated?'>authenticated?</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_digest'>digest</span> <span class='op'>=</span> <span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_attribute'>attribute</span><span class='embexpr_end'>}</span><span class='tstring_content'>_digest</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_digest'>digest</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_digest'>digest</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_is_password?'>is_password?</span><span class='lparen'>(</span><span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># returns a session token to prevent session hijacking
</span>  <span class='comment'># we reuse the remember digest for convenience
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_session_token'>session_token</span>
    <span class='id identifier rubyid_remember_digest'>remember_digest</span> <span class='op'>||</span> <span class='id identifier rubyid_remember'>remember</span>
  <span class='kw'>end</span>

  <span class='comment'># activates an account
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_activate'>activate</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends an activation e-mail
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_activation_email'>send_activation_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_account_activation'><span class='object_link'><a href="UserMailer.html#account_activation-instance_method" title="UserMailer#account_activation (method)">account_activation</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># sets password reset attributes
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_reset_digest'>create_reset_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset_token'>reset_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_reset_token'>reset_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_sent_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends password reset email
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_password_reset_email'>send_password_reset_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_password_reset'><span class='object_link'><a href="UserMailer.html#password_reset-instance_method" title="UserMailer#password_reset (method)">password_reset</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># returns true if a password reset has expired
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_password_reset_expired?'>password_reset_expired?</span>
    <span class='id identifier rubyid_reset_sent_at'>reset_sent_at</span> <span class='op'>&lt;</span> <span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_hours'>hours</span><span class='period'>.</span><span class='id identifier rubyid_ago'>ago</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># convert email to all lowercase
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_downcase_email'>downcase_email</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span> <span class='op'>=</span> <span class='id identifier rubyid_email'>email</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
  <span class='kw'>end</span>

  <span class='comment'># creates and assignes the activation token and digest
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_activation_digest'>create_activation_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_token'>activation_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_digest'>activation_digest</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_activation_token'>activation_token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="reset_token=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="reset_token-instance_method">
  
    #<strong>reset_token</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>we need an attribute ‘remember_token’, ‘activation_token’ and ‘reset_token’ to store the token this line smells of :reek:Attribute</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


64
65
66</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 64</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reset_token'>reset_token</span>
  <span class='ivar'>@reset_token</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="updated_at=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="updated_at-instance_method">
  
    #<strong>updated_at</strong>  &#x21d2; <tt>Time</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Time</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 38</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="ApplicationRecord.html" title="ApplicationRecord (class)">ApplicationRecord</a></span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span>
  <span class='comment'># this is from Michael Hartl&#39;s Rails Tutorial
</span>  <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z</span><span class='regexp_end'>/i</span></span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:email</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>format:</span> <span class='lbrace'>{</span> <span class='label'>with:</span> <span class='const'><span class='object_link'><a href="#VALID_EMAIL_REGEX-constant" title="User::VALID_EMAIL_REGEX (constant)">VALID_EMAIL_REGEX</a></span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>uniqueness:</span> <span class='kw'>true</span>

  <span class='id identifier rubyid_has_secure_password'>has_secure_password</span>
  <span class='id identifier rubyid_validates'>validates</span> <span class='symbol'>:password</span><span class='comma'>,</span> <span class='label'>presence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>length:</span> <span class='lbrace'>{</span> <span class='label'>minimum:</span> <span class='int'>6</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_has_one_attached'>has_one_attached</span> <span class='symbol'>:avatar</span>

  <span class='comment'># application relations
</span>  <span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:books</span><span class='comma'>,</span> <span class='label'>dependent:</span> <span class='symbol'>:destroy</span>

  <span class='comment'># scopes
</span>  <span class='comment'># all users but the one with a specific ID
</span>  <span class='id identifier rubyid_scope'>scope</span> <span class='symbol'>:all_but</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_where'>where</span><span class='period'>.</span><span class='id identifier rubyid_not'>not</span><span class='lparen'>(</span><span class='label'>id:</span> <span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

  <span class='comment'># returns the hash digest of the given string
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cost'>cost</span> <span class='op'>=</span> <span class='const'>ActiveModel</span><span class='op'>::</span><span class='const'>SecurePassword</span><span class='period'>.</span><span class='id identifier rubyid_min_cost'>min_cost</span> <span class='op'>?</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='op'>::</span><span class='const'>MIN_COST</span> <span class='op'>:</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='period'>.</span><span class='id identifier rubyid_cost'>cost</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='label'>cost:</span> <span class='id identifier rubyid_cost'>cost</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># we need an attribute &#39;remember_token&#39;, &#39;activation_token&#39; and &#39;reset_token&#39; to store the token
</span>  <span class='comment'># this line smells of :reek:Attribute
</span>  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:remember_token</span><span class='comma'>,</span> <span class='symbol'>:activation_token</span><span class='comma'>,</span> <span class='symbol'>:reset_token</span>

  <span class='comment'># convert e-mail address to lowercase before saving
</span>  <span class='id identifier rubyid_before_save'>before_save</span> <span class='symbol'>:downcase_email</span>
  <span class='comment'># automatically create an activation digest
</span>  <span class='id identifier rubyid_before_create'>before_create</span> <span class='symbol'>:create_activation_digest</span>

  <span class='comment'># returns a random token.
</span>  <span class='comment'># this is a CLASS method
</span>  <span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_urlsafe_base64'>urlsafe_base64</span>
  <span class='kw'>end</span>

  <span class='comment'># Remembers a user in the database for use in persistent sessions
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_remember'>remember</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_remember_token'>remember_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_remember_token'>remember_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_remember_digest'>remember_digest</span>
  <span class='kw'>end</span>

  <span class='comment'># forgets a user
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_forget'>forget</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># returns true if the given token matches the digest
</span>  <span class='comment'># this method smells of :reek:NilCheck
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_authenticated?'>authenticated?</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_digest'>digest</span> <span class='op'>=</span> <span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_attribute'>attribute</span><span class='embexpr_end'>}</span><span class='tstring_content'>_digest</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_digest'>digest</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_digest'>digest</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_is_password?'>is_password?</span><span class='lparen'>(</span><span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># returns a session token to prevent session hijacking
</span>  <span class='comment'># we reuse the remember digest for convenience
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_session_token'>session_token</span>
    <span class='id identifier rubyid_remember_digest'>remember_digest</span> <span class='op'>||</span> <span class='id identifier rubyid_remember'>remember</span>
  <span class='kw'>end</span>

  <span class='comment'># activates an account
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_activate'>activate</span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends an activation e-mail
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_activation_email'>send_activation_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_account_activation'><span class='object_link'><a href="UserMailer.html#account_activation-instance_method" title="UserMailer#account_activation (method)">account_activation</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># sets password reset attributes
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_reset_digest'>create_reset_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset_token'>reset_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_reset_token'>reset_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_sent_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
    <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='kw'>end</span>

  <span class='comment'># sends password reset email
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_send_password_reset_email'>send_password_reset_email</span>
    <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_password_reset'><span class='object_link'><a href="UserMailer.html#password_reset-instance_method" title="UserMailer#password_reset (method)">password_reset</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
  <span class='kw'>end</span>

  <span class='comment'># returns true if a password reset has expired
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_password_reset_expired?'>password_reset_expired?</span>
    <span class='id identifier rubyid_reset_sent_at'>reset_sent_at</span> <span class='op'>&lt;</span> <span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_hours'>hours</span><span class='period'>.</span><span class='id identifier rubyid_ago'>ago</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># convert email to all lowercase
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_downcase_email'>downcase_email</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span> <span class='op'>=</span> <span class='id identifier rubyid_email'>email</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
  <span class='kw'>end</span>

  <span class='comment'># creates and assignes the activation token and digest
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_activation_digest'>create_activation_digest</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_token'>activation_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_digest'>activation_digest</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_activation_token'>activation_token</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="digest-class_method">
  
    .<strong>digest</strong>(string)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>returns the hash digest of the given string</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


57
58
59
60</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 57</span>

<span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'>digest</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cost'>cost</span> <span class='op'>=</span> <span class='const'>ActiveModel</span><span class='op'>::</span><span class='const'>SecurePassword</span><span class='period'>.</span><span class='id identifier rubyid_min_cost'>min_cost</span> <span class='op'>?</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='op'>::</span><span class='const'>MIN_COST</span> <span class='op'>:</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Engine</span><span class='period'>.</span><span class='id identifier rubyid_cost'>cost</span>
  <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='label'>cost:</span> <span class='id identifier rubyid_cost'>cost</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="new_token-class_method">
  
    .<strong>new_token</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>returns a random token. this is a CLASS method</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


73
74
75</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 73</span>

<span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'>new_token</span>
  <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_urlsafe_base64'>urlsafe_base64</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="activate-instance_method">
  
    #<strong>activate</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>activates an account</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


108
109
110
111
112
113</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 108</span>

<span class='kw'>def</span> <span class='id identifier rubyid_activate'>activate</span>
  <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>  <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:activated_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
  <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="authenticated?-instance_method">
  
    #<strong>authenticated?</strong>(attribute, token)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>returns true if the given token matches the digest this method smells of :reek:NilCheck</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


95
96
97
98
99</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 95</span>

<span class='kw'>def</span> <span class='id identifier rubyid_authenticated?'>authenticated?</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_digest'>digest</span> <span class='op'>=</span> <span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_attribute'>attribute</span><span class='embexpr_end'>}</span><span class='tstring_content'>_digest</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_digest'>digest</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_digest'>digest</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_is_password?'>is_password?</span><span class='lparen'>(</span><span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_activation_digest-instance_method">
  
    #<strong>create_activation_digest</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(private)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>creates and assignes the activation token and digest</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


147
148
149
150</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 147</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_activation_digest'>create_activation_digest</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_token'>activation_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_activation_digest'>activation_digest</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_activation_token'>activation_token</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_reset_digest-instance_method">
  
    #<strong>create_reset_digest</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>sets password reset attributes</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


121
122
123
124
125
126
127</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 121</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_reset_digest'>create_reset_digest</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset_token'>reset_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
  <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>  <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_reset_token'>reset_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:reset_sent_at</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>
  <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="downcase_email-instance_method">
  
    #<strong>downcase_email</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(private)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>convert email to all lowercase</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


142
143
144</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 142</span>

<span class='kw'>def</span> <span class='id identifier rubyid_downcase_email'>downcase_email</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span> <span class='op'>=</span> <span class='id identifier rubyid_email'>email</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="forget-instance_method">
  
    #<strong>forget</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>forgets a user</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


87
88
89
90
91</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 87</span>

<span class='kw'>def</span> <span class='id identifier rubyid_forget'>forget</span>
  <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>  <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="password_reset_expired?-instance_method">
  
    #<strong>password_reset_expired?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>returns true if a password reset has expired</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


135
136
137</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 135</span>

<span class='kw'>def</span> <span class='id identifier rubyid_password_reset_expired?'>password_reset_expired?</span>
  <span class='id identifier rubyid_reset_sent_at'>reset_sent_at</span> <span class='op'>&lt;</span> <span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_hours'>hours</span><span class='period'>.</span><span class='id identifier rubyid_ago'>ago</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remember-instance_method">
  
    #<strong>remember</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Remembers a user in the database for use in persistent sessions</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


78
79
80
81
82
83
84</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 78</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remember'>remember</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_remember_token'>remember_token</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_token'><span class='object_link'><a href="#new_token-class_method" title="User.new_token (method)">new_token</a></span></span>
  <span class='comment'># rubocop:disable Rails/SkipsModelValidations
</span>  <span class='id identifier rubyid_update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='symbol'>:remember_digest</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_digest'><span class='object_link'><a href="#digest-class_method" title="User.digest (method)">digest</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_remember_token'>remember_token</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='comment'># rubocop:enable Rails/SkipsModelValidations
</span>  <span class='id identifier rubyid_remember_digest'>remember_digest</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="send_activation_email-instance_method">
  
    #<strong>send_activation_email</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>sends an activation e-mail</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


116
117
118</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 116</span>

<span class='kw'>def</span> <span class='id identifier rubyid_send_activation_email'>send_activation_email</span>
  <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_account_activation'><span class='object_link'><a href="UserMailer.html#account_activation-instance_method" title="UserMailer#account_activation (method)">account_activation</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="send_password_reset_email-instance_method">
  
    #<strong>send_password_reset_email</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>sends password reset email</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


130
131
132</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 130</span>

<span class='kw'>def</span> <span class='id identifier rubyid_send_password_reset_email'>send_password_reset_email</span>
  <span class='const'><span class='object_link'><a href="UserMailer.html" title="UserMailer (class)">UserMailer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_password_reset'><span class='object_link'><a href="UserMailer.html#password_reset-instance_method" title="UserMailer#password_reset (method)">password_reset</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver_now'>deliver_now</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="session_token-instance_method">
  
    #<strong>session_token</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>returns a session token to prevent session hijacking we reuse the remember digest for convenience</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


103
104
105</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 103</span>

<span class='kw'>def</span> <span class='id identifier rubyid_session_token'>session_token</span>
  <span class='id identifier rubyid_remember_digest'>remember_digest</span> <span class='op'>||</span> <span class='id identifier rubyid_remember'>remember</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Sep 12 18:37:03 2022 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.28 (ruby-3.1.2).
</div>

    </div>
  </body>
</html>